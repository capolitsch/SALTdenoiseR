<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Denoise a polarized spectrum — denoise_polarized_spectrum • SALTdenoiseR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Denoise a polarized spectrum — denoise_polarized_spectrum" />
<meta property="og:description" content="
 Denoise a polarized spectrum." />
<meta property="og:image" content="https://capolitsch.github.io/SALTdenoiseR/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SALTdenoiseR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Package contents</a>
</li>
<li>
  <a href="../authors.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/capolitsch/SALTdenoiseR">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Denoise a polarized spectrum</h1>
    <small class="dont-index">Source: <a href='https://github.com/capolitsch/SALTdenoiseR/blob/main/R/denoising.R'><code>R/denoising.R</code></a></small>
    <div class="hidden name"><code>denoise_polarized_spectrum.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
 Denoise a polarized spectrum.</p>
    </div>

    <pre class="usage"><span class='fu'>denoise_polarized_spectrum</span><span class='op'>(</span>
  <span class='va'>wavelength</span>,
  <span class='va'>stokes</span>,
  <span class='va'>variances</span>,
  <span class='va'>masks</span>,
  break_at <span class='op'>=</span> <span class='fl'>10</span>,
  min_pix_segment <span class='op'>=</span> <span class='fl'>10</span>,
  compute_uncertainties <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>sure_args</span>,
  <span class='va'>bootstrap_args</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>wavelength</th>
      <td><p>Vector of wavelength measurements.</p></td>
    </tr>
    <tr>
      <th>stokes</th>
      <td><p>Polarized spectrum measurements, passed as a 3-column tibble,
data frame, or matrix, with the columns corresponding to the Stokes
parameters I, Q, and U, respectively.</p></td>
    </tr>
    <tr>
      <th>variances</th>
      <td><p>Measurement variances, in a tibble, data frame, or matrix
with dimensions matching those of <code>stokes</code>.</p></td>
    </tr>
    <tr>
      <th>masks</th>
      <td><p>Pixel masks, in a tibble, data frame, or matrix
with dimensions matching those of <code>stokes</code>. Nonzero elements flag bad pixels.</p></td>
    </tr>
    <tr>
      <th>break_at</th>
      <td><p>A free parameter that controls the segmentation of a
spectrum. More precisely, <code>break_at</code> is the minimum number of
consecutively-masked spectral pixels that will trigger a break in the
spectrum. Defaults to <code>break_at = 10</code>.</p></td>
    </tr>
    <tr>
      <th>min_pix_segment</th>
      <td><p>After the segmentation procedure is complete, the
resulting segments are examined to ensure that each is sufficiently long for
an independent denoising analysis. In particular, any segment that has less
than <code>min_pix_segment</code> unmasked spectral pixels is discarded. Defaults to
<code>min_pix_segment = 10</code>.</p></td>
    </tr>
    <tr>
      <th>compute_uncertainties</th>
      <td><p>(Boolean) If <code>TRUE</code>, then variability bands are
computed for each of the denoised normalized Stokes spectra, via a parametric
bootstrap algorithm.</p></td>
    </tr>
    <tr>
      <th>sure_args</th>
      <td><p>Additional named arguments to be passed to
<a href='https://capolitsch.github.io/trendfiltering/reference/sure_trendfilter.html'>sure_trendfilter()</a>.</p></td>
    </tr>
    <tr>
      <th>bootstrap_args</th>
      <td><p>Additional named arguments to be passed to
<a href='https://capolitsch.github.io/trendfiltering/reference/bootstrap_trendfilter.html'>bootstrap_trendfilter()</a>. The
argument <code>bootstrap_algorithm = "parametric"</code> is fixed due to the
design of SALT spectra, and we don't allow this argument to be manually
overridden. See the
<a href='https://capolitsch.github.io/trendfiltering/reference/bootstrap_trendfilter.html'>bootstrap_trendfilter()</a>
documentation and
<a href='https://academic.oup.com/mnras/article/492/3/4005/5704413'>Politsch et al. (2020a)</a>
for details on why this particular bootstrap algorithm is appropriate for
SALT spectra.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>'polarized_spectrum'</code>. This is a list
with the following elements:</p>
<dt>n_segments</dt><dd><p>The number of segments the spectrum was broken into.</p></dd>
<dt>denoised_spectra</dt><dd><p>A tibble containing denoised spectra for
each of the 3 Stokes parameters, as well as Q/I and U/I. The full column set
is <code><a href='https://rdrr.io/r/base/c.html'>c("wavelength","stokes_I","stokes_Q","stokes_U","Q_norm","U_norm")</a></code>.</p></dd>
<dt>stokes_I_ensemble</dt><dd><p>If <code>compute_uncertainties = TRUE</code>, the
full bootstrap ensemble for the Stokes I parameter,
as an \(n \times B\) matrix, less any columns from post-hoc pruning.
If <code>compute_uncertainties = FALSE</code>, this will return <code>NULL</code>.</p></dd>
<dt>stokes_Q_ensemble</dt><dd><p>Same as above, but for the Q Stokes parameter.</p></dd>
<dt>stokes_U_ensemble</dt><dd><p>Same as above, but for the U Stokes parameter.</p></dd>
<dt>Q_norm_ensemble</dt><dd><p>Same as above, but for Q/I.</p></dd>
<dt>U_norm_ensemble</dt><dd><p>Same as above, but for U/I.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Politsch et al. (2020a).
<a href='https://academic.oup.com/mnras/article/492/3/4005/5704413'>
Trend filtering – I. A modern statistical tool for time-domain astronomy and
astronomical spectroscopy</a>. <em>MNRAS</em>, 492(3), p. 4005-4018. <br /></p></li>
<li><p>Politsch et al. (2020b).
<a href='https://academic.oup.com/mnras/article/492/3/4019/5704414'>
Trend Filtering – II. Denoising astronomical signals with varying degrees of
smoothness</a>. <em>MNRAS</em>, 492(3), p. 4019-4032.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>polarized_spectrum_WR_star</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>wavelength</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>
  from <span class='op'>=</span> <span class='va'>sci</span><span class='op'>$</span><span class='va'>axDat</span><span class='op'>$</span><span class='va'>crval</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  by <span class='op'>=</span> <span class='va'>sci</span><span class='op'>$</span><span class='va'>axDat</span><span class='op'>$</span><span class='va'>cdelt</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  length <span class='op'>=</span> <span class='va'>sci</span><span class='op'>$</span><span class='va'>axDat</span><span class='op'>$</span><span class='va'>len</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='op'>)</span>

<span class='va'>stokes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>sci</span><span class='op'>$</span><span class='va'>imDat</span><span class='op'>)</span>
<span class='va'>variances</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>var</span><span class='op'>$</span><span class='va'>imDat</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>masks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>bpm</span><span class='op'>$</span><span class='va'>imDat</span><span class='op'>)</span>

<span class='va'>spec_denoised</span> <span class='op'>&lt;-</span> <span class='fu'>denoise_polarized_spectrum</span><span class='op'>(</span><span class='va'>wavelength</span>, <span class='va'>stokes</span>, <span class='va'>variances</span>, <span class='va'>masks</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: all scheduled cores encountered errors in user code</span></div><div class='output co'>#&gt; <span class='error'>Error in tf_obj[[X]][["x_eval"]]: subscript out of bounds</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://collinpolitsch.com/'>Collin A. Politsch</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


