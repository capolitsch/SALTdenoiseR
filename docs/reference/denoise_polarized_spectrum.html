<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Denoise a SALT Observatory spectrum via quadratic trend filtering and compute
uncertainties via a bootstrap — denoise_polarized_spectrum • SALTdenoiseR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Denoise a SALT Observatory spectrum via quadratic trend filtering and compute
uncertainties via a bootstrap — denoise_polarized_spectrum" />
<meta property="og:description" content="Denoise a SALT Observatory spectrum via quadratic trend filtering and compute
uncertainties via a bootstrap" />
<meta property="og:image" content="https://capolitsch.github.io/SALTdenoiseR/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SALTdenoiseR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Package contents</a>
</li>
<li>
  <a href="../authors.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/capolitsch/SALTdenoiseR">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Denoise a SALT Observatory spectrum via quadratic trend filtering and compute
uncertainties via a bootstrap</h1>
    <small class="dont-index">Source: <a href='https://github.com/capolitsch/SALTdenoiseR/blob/main/R/denoising.R'><code>R/denoising.R</code></a></small>
    <div class="hidden name"><code>denoise_polarized_spectrum.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Denoise a SALT Observatory spectrum via quadratic trend filtering and compute
uncertainties via a bootstrap</p>
    </div>

    <pre class="usage"><span class='fu'>denoise_polarized_spectrum</span><span class='op'>(</span>
  <span class='va'>wavelength</span>,
  <span class='va'>stokes</span>,
  <span class='va'>variances</span>,
  <span class='va'>masks</span>,
  break_at <span class='op'>=</span> <span class='fl'>10</span>,
  min_pix_segment <span class='op'>=</span> <span class='fl'>10</span>,
  compute_uncertainties <span class='op'>=</span> <span class='cn'>FALSE</span>,
  mc_cores <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>stokes</th>
      <td><p>Spectropolarimetric measurements in a Stokes parametrization,
passed as a 3-column matrix, with the columns corresponding to the I, Q, U
Stokes parameters, respectively.</p></td>
    </tr>
    <tr>
      <th>variances</th>
      <td><p>Measurement variances, in a matrix with dimensions matching
those of <code>stokes</code>.</p></td>
    </tr>
    <tr>
      <th>masks</th>
      <td><p>Pixel masks, in a matrix with dimensions matching those
of <code>stokes</code>. Nonzero elements flag bad pixels.</p></td>
    </tr>
    <tr>
      <th>break_at</th>
      <td><p>A free parameter that controls the segmentation of a
spectrum. More precisely, <code>break_at</code> is the minimum number of
consecutively-masked spectral pixels that will trigger a break in the
spectrum. Defaults to <code>break_at = 10</code>.</p></td>
    </tr>
    <tr>
      <th>min_pix_segment</th>
      <td><p>After the segmentation procedure is complete, it is
advisable to examine the resulting segments to ensure that each is
sufficiently long for its own denoising analysis. In particular, we discard
any segments that have less than <code>min_pix_segment</code> unmasked spectral pixels.
Defaults to <code>min_pix_segment = 10</code>.</p></td>
    </tr>
    <tr>
      <th>compute_uncertainties</th>
      <td><p>(Boolean) If <code>TRUE</code> then variability bands are
computed for each of the denoised normalized Stokes spectra, via a parametric
bootstrap algorithm.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional named arguments to be passed to
<code><a href='https://capolitsch.github.io/trendfiltering/reference/sure_trendfilter.html'>trendfiltering::sure_trendfilter()</a></code> or
<code><a href='https://capolitsch.github.io/trendfiltering/reference/bootstrap_trendfilter.html'>trendfiltering::bootstrap_trendfilter()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class
<code>'polarized_spectrum_denoised'</code>.
This is a list with the following elements:</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Politsch et al. (2020a).
<a href='https://academic.oup.com/mnras/article/492/3/4005/5704413'>
Trend filtering – I. A modern statistical tool for time-domain astronomy and
astronomical spectroscopy</a>. <em>MNRAS</em>, 492(3), p. 4005-4018. <br /></p></li>
<li><p>Politsch et al. (2020b).
<a href='https://academic.oup.com/mnras/article/492/3/4019/5704414'>
Trend Filtering – II. Denoising astronomical signals with varying degrees of
smoothness</a>. <em>MNRAS</em>, 492(3), p. 4019-4032.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>SALT_spectrum</span><span class='op'>)</span>

<span class='va'>wavelength</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>
  from <span class='op'>=</span> <span class='va'>sci</span><span class='op'>$</span><span class='va'>axDat</span><span class='op'>$</span><span class='va'>crval</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  by <span class='op'>=</span> <span class='va'>sci</span><span class='op'>$</span><span class='va'>axDat</span><span class='op'>$</span><span class='va'>cdelt</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  length <span class='op'>=</span> <span class='va'>sci</span><span class='op'>$</span><span class='va'>axDat</span><span class='op'>$</span><span class='va'>len</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='op'>)</span>

<span class='va'>stokes</span> <span class='op'>&lt;-</span> <span class='fu'>as_tibble</span><span class='op'>(</span><span class='va'>sci</span><span class='op'>$</span><span class='va'>imDat</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rename_with</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>.cols</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"I"</span>, <span class='st'>"Q"</span>, <span class='st'>"U"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>variances</span> <span class='op'>&lt;-</span> <span class='fu'>as_tibble</span><span class='op'>(</span><span class='va'>var</span><span class='op'>$</span><span class='va'>imDat</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rename_with</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>.cols</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"I_vars"</span>, <span class='st'>"Q_vars"</span>, <span class='st'>"U_vars"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>masks</span> <span class='op'>&lt;-</span> <span class='fu'>as_tibble</span><span class='op'>(</span><span class='va'>bpm</span><span class='op'>$</span><span class='va'>imDat</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>rename_with</span><span class='op'>(</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>.cols</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"I_mask"</span>, <span class='st'>"Q_mask"</span>, <span class='st'>"U_mask"</span><span class='op'>)</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://collinpolitsch.com/'>Collin A. Politsch</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


